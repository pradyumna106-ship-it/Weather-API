services:
  # Redis service first
  - type: redis
    name: weather-redis
    ipAllowList: []  # Internal only
    maxmemoryPolicy: allkeys-lru  # Eviction policy

  # Spring Boot web service
  - type: pserv
    name: weather-api-spring
    env: java
    buildCommand: ./mvnw clean package -DskipTests
    startCommand: java -jar target/*.jar
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: production
      - key: REDIS_URL
        fromService:
          type: redis
          name: weather-redis
          property: connectionString  # Injects full redis:// URL
      - key: WEATHER_API_KEY
        value: FR83YB9XB8B468JLR4HKMTEAR  # Externalize later

